(function(_0x16edc8, _0x524898) {
    const _0x171c95 = _0x41ef,
        _0x47deaa = _0x16edc8();
    while (!![]) {
        try {
            const _0x1fa225 =
                (-parseInt(_0x171c95(0x254)) / 0x1) * (parseInt(_0x171c95(0x1e7)) / 0x2) +
                (parseInt(_0x171c95(0x253)) / 0x3) * (parseInt(_0x171c95(0x236)) / 0x4) +
                (parseInt(_0x171c95(0x201)) / 0x5) * (-parseInt(_0x171c95(0x241)) / 0x6) +
                parseInt(_0x171c95(0x1eb)) / 0x7 +
                -parseInt(_0x171c95(0x25e)) / 0x8 +
                (parseInt(_0x171c95(0x24a)) / 0x9) * (parseInt(_0x171c95(0x228)) / 0xa) +
                parseInt(_0x171c95(0x267)) / 0xb;
            if (_0x1fa225 === _0x524898) break;
            else _0x47deaa["push"](_0x47deaa["shift"]());
        } catch (_0x1ab25f) {
            _0x47deaa["push"](_0x47deaa["shift"]());
        }
    }
})(_0xada2, 0xa1d57);
import _0xcb30c5 from "./luckysheetConfigsetting";
import _0x20c91d from "../store";
function _0x41ef(_0x34f777, _0x415e41) {
    const _0xada2e0 = _0xada2();
    return (
        (_0x41ef = function(_0x41ef9f, _0x2fa3c8) {
            _0x41ef9f = _0x41ef9f - 0x1e7;
            let _0x102dfe = _0xada2e0[_0x41ef9f];
            return _0x102dfe;
        }),
        _0x41ef(_0x34f777, _0x415e41)
    );
}
import _0x50f723 from "../locale/locale";
import { replaceHtml } from "../utils/util";
import { modelHTML } from "./constant";
function _0xada2() {
    const _0x2c8a9d = [
        "selectArea",
        "</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22luckysheet-print-title\x22>",
        "chart_id",
        "luckysheet-print-preview",
        "padding",
        "</button><button\x20class=\x22btn\x20btn-default\x20luckysheet-model-close-btn\x22>",
        "area",
        "9790696jIVBpg",
        "closePath",
        "remove",
        "law",
        "handleChart",
        "canvas",
        "drawImage",
        "css",
        "</label></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div><input\x20value=\x221\x22\x20name=\x22print\x22\x20type=\x22radio\x22\x20id=\x22vertical\x22/><label\x20for=\x22vertical\x22>",
        "4513069evnNky",
        "(18.4cm×26.7cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22luckysheet-print-title\x22>",
        "getElementById",
        "</button>",
        "outerHeight",
        "key",
        "luckysheet-print-box",
        "current",
        "</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20class=\x22luckysheet-print-select-area\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x220\x22\x20selected=\x22selected\x22>",
        "body",
        "printBefore",
        "forEach",
        "direction",
        "title",
        "ch_width",
        "canvasList",
        "off",
        "suggest",
        "577282JillAq",
        ".luckysheet-print-break",
        "container",
        "click.printConfirm",
        "7653674XfiZko",
        ".luckysheet-print-select-area",
        "querySelector",
        "beginPath",
        "value",
        "push",
        "drawCanvas",
        "className",
        "vertical",
        "<canvas>",
        "onafterprint",
        "#luckysheet-print",
        ".luckysheet-modal-dialog-content",
        "div",
        "drawLine",
        "saveRange",
        "width",
        "end",
        "top_move",
        ".luckysheet-print-radio\x20input",
        "index",
        "left_move",
        "255RhkGJO",
        "</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22luckysheet-print-radio\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div><input\x20value=\x220\x22\x20name=\x22print\x22\x20type=\x22radio\x22\x20id=\x22horizontal\x22\x20checked/><label\x20for=\x22horizontal\x22>",
        "horizontal",
        "</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20class=\x22luckysheet-print-size\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x220\x22>A3(29.7cm×42.0cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x221\x22\x20selected=\x22selected\x22>A4(21.0cm×29.7cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x222\x22>A5(14.8cm×21.0cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x223\x22>B4(25.0cm×35.3cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x224\x22>B5(17.6cm×25.0cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x225\x22>",
        "style",
        "change.printSize",
        "luckysheetfile",
        ".luckysheet-print\x20.luckysheet-model-confirm-btn",
        "luckysheet_select_save",
        "scrollTop",
        "strokeStyle",
        "find",
        "size",
        "bottom",
        "(21.6cm×35.6cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x228\x22>",
        "breakPage",
        "close",
        "min",
        "onbeforeprint",
        "outerWidth",
        "originHeight",
        "images",
        "devicePixelRatio",
        "all",
        "findIndex",
        "</label></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>",
        "visibledatacolumn",
        "sizeList",
        "lineWidth",
        "visibledatarow",
        "margin",
        "moveTo",
        "</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x221\x22>",
        "change.printInput",
        "px\x20auto",
        "letter",
        "currentSheetIndex",
        "<div\x20class=\x22luckysheet-print-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22luckysheet-print-suggest\x22>",
        "top",
        "20qeQKfa",
        "min-width",
        "findValue",
        "</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22luckysheet-print-title\x22>",
        "range",
        "right",
        "left",
        "row",
        "luckysheet-print-canvas",
        "currentTarget",
        "column",
        ".luckysheet-print-viewBtn",
        "default",
        "show",
        "4uCmoOe",
        "paper",
        "print",
        "stroke",
        "append",
        "appendChild",
        "admin",
        "src",
        "getContext",
        "ceil",
        "width_move",
        "50826PTydBw",
        "attr",
        "then",
        "flowdata",
        "originWidth",
        "change.printArea",
        "height",
        "unshift",
        "scrollLeft",
        "4558581ymofry",
        "luckysheet-print",
        "height_move",
        "lineTo",
        "max",
        "length",
        "createElement",
        ".luckysheet-print-preview",
        "onload",
        "272073EVmsLo",
        "1xwesGY",
        "get",
        "hide",
    ];
    _0xada2 = function() {
        return _0x2c8a9d;
    };
    return _0xada2();
}
import { luckysheetDrawMain } from "../global/draw";
import { luckysheetdefaultstyle } from "./constant";
export function printInitial() {
    const _0x4fa1e3 = _0x41ef;
    let _0x2edd68 = _0xcb30c5[_0x4fa1e3(0x1e9)],
        _0x1a6df3 = this;
    $("#" + _0x2edd68)
        [_0x4fa1e3(0x20c)](_0x4fa1e3(0x233))
        ["click"](function() {
            switchViewBtn($(this));
        });
}
export const luckysheetPrint = {
    selectArea: "0",
    direction: "0",
    size: "1",
    sizeList: [
        [29.7, 0x2a],
        [0x15, 29.7],
        [14.8, 0x15],
        [0x19, 35.3],
        [17.6, 0x19],
        [21.6, 27.9],
        [27.9, 43.2],
        [21.6, 35.6],
        [18.4, 26.7],
    ],
    padding: [0x14, 0x14, 0x14, 0x14],
    saveRange: null,
    canvasList: [],
    createDialog: function() {
        const _0x4f1a9e = _0x41ef;
        $("#luckysheet-modal-dialog-mask")[_0x4f1a9e(0x256)](), $(_0x4f1a9e(0x1f6))[_0x4f1a9e(0x260)]();
        const _0x2bc49d = _0x50f723(),
            _0x486dcf = _0x2bc49d[_0x4f1a9e(0x238)],
            _0x59a02c = _0x2bc49d["button"];
        let _0x356c6c =
            _0x4f1a9e(0x226) +
            _0x486dcf[_0x4f1a9e(0x278)] +
            _0x4f1a9e(0x22b) +
            _0x486dcf[_0x4f1a9e(0x22c)] +
            _0x4f1a9e(0x26f) +
            _0x486dcf[_0x4f1a9e(0x26e)] +
            _0x4f1a9e(0x221) +
            _0x486dcf[_0x4f1a9e(0x25d)] +
            _0x4f1a9e(0x258) +
            _0x486dcf["size"] +
            _0x4f1a9e(0x204) +
            _0x486dcf[_0x4f1a9e(0x224)] +
            "(21.6cm×27.9cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x226\x22>" +
            _0x486dcf[_0x4f1a9e(0x237)] +
            "(27.9cm×43.2cm)</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x227\x22>" +
            _0x486dcf[_0x4f1a9e(0x261)] +
            _0x4f1a9e(0x20f) +
            _0x486dcf[_0x4f1a9e(0x23c)] +
            _0x4f1a9e(0x268) +
            _0x486dcf[_0x4f1a9e(0x273)] +
            _0x4f1a9e(0x202) +
            _0x486dcf[_0x4f1a9e(0x203)] +
            _0x4f1a9e(0x266) +
            _0x486dcf[_0x4f1a9e(0x1f3)] +
            _0x4f1a9e(0x21a);
        $(_0x4f1a9e(0x270))[_0x4f1a9e(0x23a)](
            replaceHtml(modelHTML, {
                id: _0x4f1a9e(0x24b),
                addclass: _0x4f1a9e(0x24b),
                title: _0x486dcf[_0x4f1a9e(0x274)],
                content: _0x356c6c,
                botton:
                    "<button\x20class=\x22btn\x20btn-default\x20luckysheet-model-confirm-btn\x22>" +
                    _0x59a02c["confirm"] +
                    _0x4f1a9e(0x25c) +
                    _0x59a02c["close"] +
                    _0x4f1a9e(0x26a),
                style: "z-index:100003",
                close: _0x59a02c[_0x4f1a9e(0x211)],
            }),
        );
        let _0x3b46cc = $(_0x4f1a9e(0x1f6))
                [_0x4f1a9e(0x20c)](_0x4f1a9e(0x1f7))
                [_0x4f1a9e(0x265)](_0x4f1a9e(0x229), 0x15e)
                [_0x4f1a9e(0x1fc)](),
            _0x5a897f = _0x3b46cc[_0x4f1a9e(0x26b)](),
            _0x1715b8 = _0x3b46cc[_0x4f1a9e(0x214)](),
            _0x30aad1 = $(window)[_0x4f1a9e(0x1fb)](),
            _0x4e9eb2 = $(window)["height"](),
            _0x313b7f = $(document)[_0x4f1a9e(0x249)](),
            _0xee6fb = $(document)[_0x4f1a9e(0x20a)]();
        $(_0x4f1a9e(0x1f6))
            [_0x4f1a9e(0x265)]({
                left: (_0x30aad1 + _0x313b7f - _0x1715b8) / 0x2,
                top: (_0x4e9eb2 + _0xee6fb - _0x5a897f) / 0x3,
            })
            [_0x4f1a9e(0x235)]();
    },
    init: function() {
        const _0x530747 = _0x41ef;
        let _0x2853eb = this;
        (this[_0x530747(0x257)] = "0"),
            (this[_0x530747(0x273)] = "0"),
            (this[_0x530747(0x20d)] = "1"),
            $(document)
                ["off"](_0x530747(0x246))
                ["on"](_0x530747(0x246), _0x530747(0x1ec), function(_0x48a17f) {
                    const _0x260ef2 = _0x530747;
                    _0x2853eb[_0x260ef2(0x257)] = _0x48a17f[_0x260ef2(0x231)][_0x260ef2(0x1ef)];
                }),
            $(document)
                [_0x530747(0x277)](_0x530747(0x206))
                ["on"](_0x530747(0x206), ".luckysheet-print-size", function(_0x1d567) {
                    const _0x571803 = _0x530747;
                    _0x2853eb[_0x571803(0x20d)] = _0x1d567["currentTarget"][_0x571803(0x1ef)];
                }),
            $(document)
                ["off"]("change.printInput")
                ["on"](_0x530747(0x222), _0x530747(0x1fe), function(_0x3b9301) {
                    const _0x381828 = _0x530747;
                    _0x2853eb[_0x381828(0x273)] = _0x3b9301[_0x381828(0x231)][_0x381828(0x1ef)];
                }),
            $(document)
                [_0x530747(0x277)](_0x530747(0x1ea))
                ["on"]("click.printConfirm", _0x530747(0x208), function() {
                    const _0x411467 = _0x530747;
                    $("#luckysheet-print")["hide"](),
                        Promise[_0x411467(0x218)](_0x2853eb[_0x411467(0x271)]())[_0x411467(0x243)]((_0x3ad7f0) => {
                            const _0xda9358 = _0x411467;
                            (_0x2853eb["canvasList"] = _0x3ad7f0), window[_0xda9358(0x238)]();
                        });
                }),
            (window[_0x530747(0x213)] = (_0x481147) => {
                const _0x3257ce = _0x530747;
                let _0x456a9b = this[_0x3257ce(0x1fa)][_0x3257ce(0x22f)][0x0],
                    _0x18ae03 = this[_0x3257ce(0x1fa)][_0x3257ce(0x22f)][0x1],
                    _0x15f971 = this["saveRange"][_0x3257ce(0x232)][0x0],
                    _0x21dd84 = this[_0x3257ce(0x1fa)][_0x3257ce(0x232)][0x1],
                    _0x2f662c,
                    _0x49082c;
                _0x456a9b - 0x1 < 0x0
                    ? ((_0x2f662c = 0x0), (_0x49082c = _0x20c91d[_0x3257ce(0x21e)][_0x18ae03]))
                    : ((_0x2f662c = _0x20c91d[_0x3257ce(0x21e)][_0x456a9b - 0x1]),
                      (_0x49082c =
                          _0x20c91d[_0x3257ce(0x21e)][_0x18ae03] - _0x20c91d[_0x3257ce(0x21e)][_0x456a9b - 0x1]));
                let _0x145e3b, _0x11119e;
                _0x15f971 - 0x1 < 0x0
                    ? ((_0x145e3b = 0x0), (_0x11119e = _0x20c91d[_0x3257ce(0x21b)][_0x21dd84]))
                    : ((_0x145e3b = _0x20c91d[_0x3257ce(0x21b)][_0x15f971 - 0x1]),
                      (_0x11119e =
                          _0x20c91d[_0x3257ce(0x21b)][_0x21dd84] - _0x20c91d[_0x3257ce(0x21b)][_0x15f971 - 0x1])),
                    this[_0x3257ce(0x1f1)](_0x11119e, _0x49082c, _0x145e3b, _0x2f662c);
            }),
            (window[_0x530747(0x1f5)] = (_0x1be04a) => {
                const _0x14cdd8 = _0x530747,
                    _0x1301bb = document[_0x14cdd8(0x1ed)](_0x14cdd8(0x251));
                _0x1301bb[_0x14cdd8(0x260)]();
            });
    },
    printBefore() {
        const _0x86a1c7 = _0x41ef,
            _0x9644c8 = [],
            _0x219307 = _0x20c91d[_0x86a1c7(0x207)][_0x86a1c7(0x20c)](
                (_0x44dfe5) => _0x44dfe5["index"] == _0x20c91d[_0x86a1c7(0x225)],
            ),
            _0x1f58a3 = _0x219307[_0x86a1c7(0x216)];
        let _0x510e70;
        if (_0x20c91d[_0x86a1c7(0x209)][_0x86a1c7(0x24f)] === 0x0 || this[_0x86a1c7(0x257)] === "0") {
            const _0x27e725 = _0x20c91d[_0x86a1c7(0x244)][0x0][_0x86a1c7(0x24f)] - 0x1,
                _0x50ea54 = _0x20c91d[_0x86a1c7(0x244)]["length"] - 0x1;
            _0x510e70 = {
                row: [0x0, _0x50ea54],
                column: [0x0, _0x27e725],
                left_move: 0x0,
                top_move: 0x0,
                width_move: _0x219307[_0x86a1c7(0x275)],
                height_move: _0x219307["rh_height"],
            };
        } else
            _0x20c91d["luckysheet_select_save"][_0x86a1c7(0x24f)] === 0x1
                ? (_0x510e70 = _0x20c91d[_0x86a1c7(0x209)][0x0])
                : (_0x510e70 =
                      _0x20c91d["luckysheet_select_save"][_0x20c91d["luckysheet_select_save"][_0x86a1c7(0x24f)] - 0x1]);
        this[_0x86a1c7(0x1fa)] = _0x510e70;
        for (let _0x5a1ca3 in _0x1f58a3) {
            const _0x4883f7 = _0x1f58a3[_0x5a1ca3],
                _0x400100 = new Image();
            (_0x400100[_0x86a1c7(0x23d)] = _0x4883f7["src"]),
                (_0x400100[_0x86a1c7(0x1fb)] = _0x4883f7[_0x86a1c7(0x245)]),
                (_0x400100[_0x86a1c7(0x247)] = _0x4883f7[_0x86a1c7(0x215)]);
            const _0x443dc6 = document["createElement"](_0x86a1c7(0x263));
            (_0x443dc6[_0x86a1c7(0x1fb)] = _0x4883f7["default"][_0x86a1c7(0x1fb)]),
                (_0x443dc6[_0x86a1c7(0x247)] = _0x4883f7[_0x86a1c7(0x234)][_0x86a1c7(0x247)]);
            const _0x4f9eb5 = _0x443dc6["getContext"]("2d");
            _0x9644c8[_0x86a1c7(0x1f0)](
                new Promise((_0xee1af8, _0x538c4c) => {
                    const _0x5bc5fe = _0x86a1c7;
                    _0x400100[_0x5bc5fe(0x252)] = () => {
                        const _0x150de6 = _0x5bc5fe;
                        _0x4f9eb5[_0x150de6(0x264)](
                            _0x400100,
                            0x0,
                            0x0,
                            _0x400100[_0x150de6(0x1fb)],
                            _0x400100[_0x150de6(0x247)],
                            0x0,
                            0x0,
                            _0x443dc6[_0x150de6(0x1fb)],
                            _0x443dc6[_0x150de6(0x247)],
                        ),
                            _0xee1af8({ key: _0x5a1ca3, canvas: _0x443dc6 });
                    };
                }),
            );
        }
        return _0x9644c8;
    },
    handleImage(_0x526944, _0x15431e) {
        const _0x17f032 = _0x41ef,
            _0x15e986 = _0x20c91d[_0x17f032(0x207)][_0x17f032(0x20c)](
                (_0x28303b) => _0x28303b[_0x17f032(0x1ff)] === _0x20c91d[_0x17f032(0x225)],
            ),
            _0x456b80 = _0x15e986[_0x17f032(0x216)][_0x15431e[_0x17f032(0x26c)]],
            _0xad342b = {
                top: _0x456b80[_0x17f032(0x234)][_0x17f032(0x227)],
                bottom: _0x456b80[_0x17f032(0x234)][_0x17f032(0x227)] + _0x456b80[_0x17f032(0x234)]["height"],
                left: _0x456b80[_0x17f032(0x234)][_0x17f032(0x22e)],
                right: _0x456b80[_0x17f032(0x234)][_0x17f032(0x22e)] + _0x456b80[_0x17f032(0x234)]["width"],
            },
            _0x171709 = {
                top: this["saveRange"][_0x17f032(0x1fd)],
                bottom: this[_0x17f032(0x1fa)][_0x17f032(0x1fd)] + this[_0x17f032(0x1fa)][_0x17f032(0x24c)],
                left: this[_0x17f032(0x1fa)][_0x17f032(0x200)],
                right: this[_0x17f032(0x1fa)][_0x17f032(0x200)] + this[_0x17f032(0x1fa)][_0x17f032(0x240)],
            };
        if (
            _0xad342b[_0x17f032(0x20e)] < _0x171709[_0x17f032(0x227)] ||
            _0xad342b[_0x17f032(0x22d)] < _0x171709["left"] ||
            _0xad342b[_0x17f032(0x22e)] > _0x171709[_0x17f032(0x22d)] ||
            _0xad342b[_0x17f032(0x227)] > _0x171709[_0x17f032(0x20e)]
        )
            return;
        let _0x3356fb, _0x1533d0, _0x195d00, _0x393559;
        (_0x3356fb = Math[_0x17f032(0x24e)](_0xad342b["left"], _0x171709[_0x17f032(0x22e)])),
            (_0x195d00 = Math[_0x17f032(0x24e)](_0xad342b["top"], _0x171709[_0x17f032(0x227)])),
            (_0x1533d0 = Math[_0x17f032(0x212)](_0xad342b[_0x17f032(0x22d)], _0x171709[_0x17f032(0x22d)])),
            (_0x393559 = Math[_0x17f032(0x212)](_0xad342b[_0x17f032(0x20e)], _0x171709[_0x17f032(0x20e)])),
            _0x526944[_0x17f032(0x264)](
                _0x15431e[_0x17f032(0x263)],
                _0x3356fb - _0xad342b["left"],
                _0x195d00 - _0xad342b[_0x17f032(0x227)],
                _0x15431e[_0x17f032(0x263)][_0x17f032(0x1fb)] - _0x3356fb + _0xad342b[_0x17f032(0x22e)],
                _0x15431e[_0x17f032(0x263)]["height"] - _0x195d00 + _0xad342b["top"],
                _0x3356fb - _0x171709[_0x17f032(0x22e)],
                _0x195d00 - _0x171709[_0x17f032(0x227)],
                _0x15431e["canvas"][_0x17f032(0x1fb)] - _0x3356fb + _0xad342b[_0x17f032(0x22e)],
                _0x15431e["canvas"][_0x17f032(0x247)] - _0x195d00 + _0xad342b[_0x17f032(0x227)],
            );
    },
    handleChart(_0x5963b1) {
        const _0x231999 = _0x41ef,
            _0x5a5b1c = _0x20c91d["luckysheetfile"][_0x231999(0x20c)](
                (_0x3a6a99) => _0x3a6a99[_0x231999(0x1ff)] === _0x20c91d[_0x231999(0x225)],
            ),
            _0x4abffc = _0x5a5b1c["chart"] ?? [];
        if (!_0x4abffc[_0x231999(0x24f)]) return;
        const _0x5f05a2 = {
            top: this[_0x231999(0x1fa)]["top_move"],
            bottom: this["saveRange"]["top_move"] + this["saveRange"][_0x231999(0x24c)],
            left: this[_0x231999(0x1fa)]["left_move"],
            right: this[_0x231999(0x1fa)][_0x231999(0x200)] + this[_0x231999(0x1fa)][_0x231999(0x240)],
        };
        for (let _0x733250 = 0x0; _0x733250 < _0x4abffc[_0x231999(0x24f)]; _0x733250++) {
            const _0x358a50 = _0x4abffc[_0x733250],
                _0xdd8f23 = {
                    top: _0x358a50["top"],
                    bottom: _0x358a50[_0x231999(0x227)] + _0x358a50["height"],
                    left: _0x358a50[_0x231999(0x22e)],
                    right: _0x358a50[_0x231999(0x22e)] + _0x358a50[_0x231999(0x1fb)],
                };
            if (
                _0xdd8f23[_0x231999(0x20e)] < _0x5f05a2[_0x231999(0x227)] ||
                _0xdd8f23["right"] < _0x5f05a2["left"] ||
                _0xdd8f23[_0x231999(0x22e)] > _0x5f05a2[_0x231999(0x22d)] ||
                _0xdd8f23[_0x231999(0x227)] > _0x5f05a2[_0x231999(0x20e)]
            )
                continue;
            const _0x1f8c64 = document[_0x231999(0x269)](_0x358a50[_0x231999(0x259)])[_0x231999(0x1ed)](
                _0x231999(0x263),
            );
            if (!_0x1f8c64) continue;
            let _0x27f76a, _0x2eeda2, _0x46cd33, _0x2da45a;
            (_0x27f76a = Math[_0x231999(0x24e)](_0xdd8f23["left"], _0x5f05a2[_0x231999(0x22e)])),
                (_0x46cd33 = Math["max"](_0xdd8f23[_0x231999(0x227)], _0x5f05a2[_0x231999(0x227)])),
                (_0x2eeda2 = Math[_0x231999(0x212)](_0xdd8f23["right"], _0x5f05a2[_0x231999(0x22d)])),
                (_0x2da45a = Math[_0x231999(0x212)](_0xdd8f23[_0x231999(0x20e)], _0x5f05a2["bottom"])),
                _0x5963b1[_0x231999(0x264)](
                    _0x1f8c64,
                    _0x27f76a - _0xdd8f23[_0x231999(0x22e)],
                    _0x46cd33 - _0xdd8f23[_0x231999(0x227)],
                    _0x1f8c64[_0x231999(0x1fb)] - _0x27f76a + _0xdd8f23[_0x231999(0x22e)],
                    _0x1f8c64[_0x231999(0x247)] - _0x46cd33 + _0xdd8f23[_0x231999(0x227)],
                    _0x27f76a - _0x5f05a2[_0x231999(0x22e)],
                    _0x46cd33 - _0x5f05a2["top"],
                    _0x1f8c64["width"] - _0x27f76a + _0xdd8f23[_0x231999(0x22e)],
                    _0x1f8c64["height"] - _0x46cd33 + _0xdd8f23["top"],
                );
        }
    },
    drawCanvas(_0x1b034d, _0x16eec7, _0x2132a2, _0x1c8026) {
        const _0x3b6e82 = _0x41ef;
        let _0x36553a = this,
            _0x4ddae5 = $(_0x3b6e82(0x1f4))
                [_0x3b6e82(0x242)]({
                    width: Math[_0x3b6e82(0x23f)](_0x1b034d * _0x20c91d[_0x3b6e82(0x217)]),
                    height: Math[_0x3b6e82(0x23f)](_0x16eec7 * _0x20c91d["devicePixelRatio"]),
                })
                [_0x3b6e82(0x265)]({ width: _0x1b034d, height: _0x16eec7 });
        luckysheetDrawMain(_0x2132a2, _0x1c8026, _0x1b034d, _0x16eec7, 0x1, 0x1, null, null, _0x4ddae5);
        const _0x429b3c = _0x4ddae5[_0x3b6e82(0x255)](0x0);
        _0x429b3c["id"] = _0x3b6e82(0x230);
        let _0x40ca9a = _0x4ddae5[_0x3b6e82(0x255)](0x0)["getContext"]("2d");
        _0x40ca9a[_0x3b6e82(0x1ee)](),
            _0x40ca9a[_0x3b6e82(0x220)](0x0, 0x0),
            _0x40ca9a["lineTo"](0x0, _0x20c91d[_0x3b6e82(0x217)] * _0x16eec7),
            (_0x40ca9a[_0x3b6e82(0x21d)] = _0x20c91d[_0x3b6e82(0x217)] * 0x2),
            (_0x40ca9a["strokeStyle"] = luckysheetdefaultstyle["strokeStyle"]),
            _0x40ca9a["stroke"](),
            _0x40ca9a["closePath"](),
            _0x40ca9a[_0x3b6e82(0x1ee)](),
            _0x40ca9a[_0x3b6e82(0x220)](0x0, 0x0),
            _0x40ca9a[_0x3b6e82(0x24d)](_0x20c91d[_0x3b6e82(0x217)] * _0x1b034d, 0x0),
            (_0x40ca9a[_0x3b6e82(0x21d)] = _0x20c91d[_0x3b6e82(0x217)] * 0x2),
            (_0x40ca9a[_0x3b6e82(0x20b)] = luckysheetdefaultstyle[_0x3b6e82(0x20b)]),
            _0x40ca9a[_0x3b6e82(0x239)](),
            _0x40ca9a[_0x3b6e82(0x25f)](),
            _0x36553a[_0x3b6e82(0x276)][_0x3b6e82(0x272)]((_0x38484a) => {
                _0x36553a["handleImage"](_0x40ca9a, _0x38484a);
            }),
            _0x36553a[_0x3b6e82(0x262)](_0x40ca9a),
            _0x36553a[_0x3b6e82(0x210)](_0x429b3c);
    },
    breakPage(_0x374fc6) {
        const _0x41d1ce = _0x41ef;
        let _0xd80754 = this;
        const _0xc83171 = _0x20c91d[_0x41d1ce(0x217)] * 0x60,
            _0x46af00 =
                (_0xd80754[_0x41d1ce(0x21c)][_0xd80754[_0x41d1ce(0x20d)]][
                    _0xd80754[_0x41d1ce(0x273)] === "0" ? 0x1 : 0x0
                ] *
                    _0xc83171) /
                    2.54 -
                0x64,
            _0x4fff65 =
                (_0xd80754[_0x41d1ce(0x21c)][_0xd80754[_0x41d1ce(0x20d)]][
                    _0xd80754[_0x41d1ce(0x273)] === "0" ? 0x0 : 0x1
                ] *
                    _0xc83171) /
                    2.54 -
                0x96,
            _0x33985b = _0x46af00 - _0xd80754[_0x41d1ce(0x25b)][0x1] - _0xd80754[_0x41d1ce(0x25b)][0x3],
            _0x1e3774 = _0x4fff65 - _0xd80754[_0x41d1ce(0x25b)][0x0] - _0xd80754["padding"][0x2];
        let _0x3662af, _0x25c011;
        if (_0xd80754[_0x41d1ce(0x257)] == "0")
            (_0x3662af = [0x0, ..._0x20c91d["visibledatacolumn"]]), (_0x25c011 = [0x0, ..._0x20c91d[_0x41d1ce(0x21e)]]);
        else {
            const _0x2ee561 = _0xd80754[_0x41d1ce(0x1fa)][_0x41d1ce(0x232)][0x0],
                _0x3caeb8 = _0xd80754[_0x41d1ce(0x1fa)][_0x41d1ce(0x232)][0x1] + 0x1;
            _0x3662af = [0x0];
            let _0x45ebcc = _0x2ee561 > 0x0 ? _0x20c91d["visibledatacolumn"][_0x2ee561 - 0x1] : 0x0;
            for (let _0x118ce6 = _0x2ee561; _0x118ce6 < _0x3caeb8; _0x118ce6++) {
                _0x3662af[_0x41d1ce(0x1f0)](_0x20c91d[_0x41d1ce(0x21b)][_0x118ce6] - _0x45ebcc);
            }
            const _0x16dbf9 = _0xd80754["saveRange"][_0x41d1ce(0x22f)][0x0],
                _0x230e94 = _0xd80754["saveRange"][_0x41d1ce(0x22f)][0x1] + 0x1;
            _0x25c011 = [0x0];
            let _0x4c4b1f = _0x16dbf9 > 0x0 ? _0x20c91d["visibledatarow"][_0x16dbf9 - 0x1] : 0x0;
            for (let _0x3f16f3 = _0x16dbf9; _0x3f16f3 < _0x230e94; _0x3f16f3++) {
                _0x25c011["push"](_0x20c91d[_0x41d1ce(0x21e)][_0x3f16f3] - _0x4c4b1f);
            }
        }
        const _0xc92ce8 = this[_0x41d1ce(0x22a)](0x0, _0x3662af[_0x41d1ce(0x24f)] - 0x1, _0x33985b, _0x3662af);
        _0xc92ce8["unshift"](0x0);
        const _0x259b6d = _0x3662af[_0x41d1ce(0x219)](
            (_0x51a4a6) => _0x51a4a6 === _0xc92ce8[_0xc92ce8[_0x41d1ce(0x24f)] - 0x1],
        );
        _0x259b6d !== _0x3662af[_0x41d1ce(0x24f)] - 0x1 &&
            _0xc92ce8[_0x41d1ce(0x1f0)](_0x3662af[_0x3662af["length"] - 0x1]);
        const _0x16e768 = this[_0x41d1ce(0x22a)](0x0, _0x25c011[_0x41d1ce(0x24f)] - 0x1, _0x1e3774, _0x25c011);
        _0x16e768[_0x41d1ce(0x248)](0x0);
        const _0x3b0906 = _0x25c011[_0x41d1ce(0x219)](
            (_0x31c942) => _0x31c942 === _0x16e768[_0x16e768[_0x41d1ce(0x24f)] - 0x1],
        );
        _0x3b0906 !== _0x25c011[_0x41d1ce(0x24f)] - 0x1 &&
            _0x16e768[_0x41d1ce(0x1f0)](_0x25c011[_0x25c011["length"] - 0x1]);
        const _0x4f6bde = document["createElement"](_0x41d1ce(0x1f8));
        (_0x4f6bde[_0x41d1ce(0x1f2)] = _0x41d1ce(0x25a)), document[_0x41d1ce(0x270)][_0x41d1ce(0x23b)](_0x4f6bde);
        for (let _0x5c2eeb = 0x0; _0x5c2eeb < _0x16e768[_0x41d1ce(0x24f)]; _0x5c2eeb++) {
            if (_0x5c2eeb == 0x0) continue;
            let _0x31ff68 = _0x16e768[_0x5c2eeb] - _0x16e768[_0x5c2eeb - 0x1];
            for (let _0x3c957c = 0x0; _0x3c957c < _0xc92ce8[_0x41d1ce(0x24f)]; _0x3c957c++) {
                if (_0x3c957c == 0x0) continue;
                width = _0xc92ce8[_0x3c957c] - _0xc92ce8[_0x3c957c - 0x1];
                const _0x20ae65 = document["createElement"](_0x41d1ce(0x1f8));
                _0x20ae65["className"] = "luckysheet-print-break";
                const _0x3942d8 = document[_0x41d1ce(0x250)]("div");
                _0x3942d8[_0x41d1ce(0x1f2)] = _0x41d1ce(0x26d);
                const _0x6a9bf = document[_0x41d1ce(0x250)](_0x41d1ce(0x263));
                (_0x6a9bf["width"] = width),
                    (_0x6a9bf[_0x41d1ce(0x247)] = _0x31ff68),
                    (_0x6a9bf[_0x41d1ce(0x205)][_0x41d1ce(0x21f)] =
                        _0xd80754[_0x41d1ce(0x25b)][0x0] + _0x41d1ce(0x223));
                const _0x98b6c9 = _0x6a9bf[_0x41d1ce(0x23e)]("2d");
                _0x98b6c9[_0x41d1ce(0x264)](
                    _0x374fc6,
                    _0xc92ce8[_0x3c957c - 0x1],
                    _0x16e768[_0x5c2eeb - 0x1],
                    width,
                    _0x31ff68,
                    0x0,
                    0x0,
                    width,
                    _0x31ff68,
                ),
                    this[_0x41d1ce(0x1f9)](_0x98b6c9, 0x0, 0x0, _0x20c91d[_0x41d1ce(0x217)] * width, 0x0),
                    this["drawLine"](_0x98b6c9, width, 0x0, width, _0x20c91d[_0x41d1ce(0x217)] * _0x31ff68),
                    this[_0x41d1ce(0x1f9)](_0x98b6c9, 0x0, _0x31ff68, width, _0x20c91d[_0x41d1ce(0x217)] * _0x31ff68),
                    this["drawLine"](_0x98b6c9, 0x0, 0x0, 0x0, _0x20c91d["devicePixelRatio"] * _0x31ff68),
                    _0x3942d8[_0x41d1ce(0x23b)](_0x6a9bf),
                    _0x4f6bde[_0x41d1ce(0x23b)](_0x3942d8),
                    _0x4f6bde[_0x41d1ce(0x23b)](_0x20ae65);
            }
            if (_0x5c2eeb === _0x16e768[_0x41d1ce(0x24f)] - 0x1) {
                const _0x6082b4 = document["querySelectorAll"](_0x41d1ce(0x1e8));
                _0x6082b4[_0x6082b4[_0x41d1ce(0x24f)] - 0x1][_0x41d1ce(0x260)]();
            }
        }
    },
    findValue(_0x2c004c, _0x460239, _0xfd92da, _0x1a10d5) {
        const _0x34df39 = _0x41ef;
        let _0x30b2da = [];
        const _0x1bff17 = _0x1a10d5[_0x2c004c];
        for (let _0x4b89bd = _0x2c004c; _0x4b89bd < _0x460239; _0x4b89bd++) {
            if (_0x1a10d5[_0x4b89bd] - _0x1bff17 > _0xfd92da) {
                (_0x30b2da = this[_0x34df39(0x22a)](_0x4b89bd, _0x460239, _0xfd92da, _0x1a10d5)),
                    _0x30b2da[_0x34df39(0x248)](_0x1a10d5[_0x4b89bd - 0x1]);
                break;
            }
        }
        return _0x30b2da;
    },
    drawLine(_0x38b4e5, _0x1c5e7a, _0x3a99da, _0x3bfb49, _0xe6f80b) {
        const _0x3e77c3 = _0x41ef;
        _0x38b4e5[_0x3e77c3(0x1ee)](),
            _0x38b4e5[_0x3e77c3(0x220)](_0x1c5e7a, _0x3a99da),
            _0x38b4e5[_0x3e77c3(0x24d)](_0x3bfb49, _0xe6f80b),
            (_0x38b4e5["lineWidth"] = _0x20c91d[_0x3e77c3(0x217)] * 0x2),
            (_0x38b4e5[_0x3e77c3(0x20b)] = luckysheetdefaultstyle[_0x3e77c3(0x20b)]),
            _0x38b4e5["stroke"](),
            _0x38b4e5[_0x3e77c3(0x25f)]();
    },
};
